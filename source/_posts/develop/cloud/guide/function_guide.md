---
title: 云函数开发指南
header: develop
nav: cloud
sidebar: cloud_function_guide
---

## 云函数使用常见问题

### 云函数使用什么语言开发和运行？
目前提供 Node.js 8.5 的运行时环境。

### 同一个函数的数次调用之间能否共享数据？
使用云函数的最佳实践之一是尽量保持云函数的无状态性。也就是说，每次调用需要保证相互独立，重复执行结果应当保持一致。云函数的调度引擎会根据调用的频率自动伸缩计算资源，对于同一个云函数，在同一时间点可能有多个实例正在工作，当函数结果返回后，这些实例可能仍会存活一段时间，以供潜在的新一次调用。因此，在一定程度内，两次调用之间是有可能共享数据的（例如在临时目录内写入的数据）。但是开发者不应当依赖这一点，因为调度引擎的行为是不可预知的，两次调用不一定会使用同一个计算资源，而且计算资源会随时被销毁重建。总体而言，开发者需要遵循云函数的无状态性原则。

### 函数运行资源有什么限制？
* 临时磁盘空间：用户函数只可读写 /tmp 这个临时目录
* 函数申请内存区间：参见配额限制
* 函数最大运行时间：参见配额限制
* 代码部署包大小(压缩为.zip文件)：50M
* 原始代码大小：250 MB
* 函数同步调用请求正文负载大小：6 MB

### 如何编写有异步过程的云函数？
将入口函数标记为 `async` 即可，Node.js 8.5 的运行时环境支持 async/await 关键词。
```js
exports.main = async (event, context) => {
    const someAsyncData = await getAsyncData()
    return someAsyncData
}
```

### 如何在函数中引用外部依赖包？
与一般的 Node.js 程序无异，编写 `package.json`文件，使用 npm 等工具将外部依赖安装至 `node_modules` 目录中，然后将这些文件一起打包上传部署即可。

### 是否需要将 `node_modules` 一起上传部署？
需要。

### 在云函数中访问云数据库和云存储，是否自带权限控制？
没有，可以任意读写数据。

### 应该使用 swan-server-sdk 的什么版本？
随着云开发的功能迭代，SDK 也不会不断更新，建议使用保持使用最新版本。SDK 更新时会尽量兼容旧版，当必须做出不兼容变更时，会使用大版本号更新。
